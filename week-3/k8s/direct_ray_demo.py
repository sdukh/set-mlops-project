#!/usr/bin/env python3
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –ø—Ä—è–º–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Ray –∫–ª–∞—Å—Ç–µ—Ä–∞
–ó–∞–ø—É—Å–∫: python direct_ray_demo.py
"""

import ray
import time
import random

print("üöÄ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –ø—Ä—è–º–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Ray –∫–ª–∞—Å—Ç–µ—Ä–∞")

# –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ—Å—è –¥–æ Ray –∫–ª–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—é –∞–¥—Ä–µ—Å—É
print("üì° –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Ray –∫–ª–∞—Å—Ç–µ—Ä–∞...")
ray.init(address="ray://localhost:10001")

print(f"‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞: {ray.cluster_resources()}")

# –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø—Ä–æ—Å—Ç—É remote —Ñ—É–Ω–∫—Ü—ñ—é
@ray.remote
def compute_task(x):
    """–ü—Ä–æ—Å—Ç–∞ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ –∑–∞–¥–∞—á–∞"""
    time.sleep(random.uniform(1, 3))  # –°–∏–º—É–ª—é—î–º–æ —Ä–æ–±–æ—Ç—É
    result = x * x + random.randint(1, 100)
    print(f"üî¢ –û–±—á–∏—Å–ª–µ–Ω–æ: {x} -> {result}")
    return result

# –ó–∞–ø—É—Å–∫–∞—î–º–æ –∫—ñ–ª—å–∫–∞ –∑–∞–¥–∞—á
print("üéØ –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á...")
futures = [compute_task.remote(i) for i in range(5)]

# –û—Ç—Ä–∏–º—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
print("‚è≥ –û—á—ñ–∫—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤...")
results = ray.get(futures)

print(f"‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç–∏: {results}")
print("üéâ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")

ray.shutdown()

if __name__ == "__main__":
    main() 